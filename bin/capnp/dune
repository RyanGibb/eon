(executable
 (name rpc)
 (modules rpc)
 (public_name rpc)
 (package eon)
 (libraries eio_main pipe capnp-rpc-unix logs.fmt))

(library
 (name pipe)
 (modules pipe pipe_api)
 (package eon)
 (libraries eio_main capnp-rpc-lwt)
 (flags
  (:standard -w -53-55)))

(rule
 (targets pipe_api.ml pipe_api.mli)
 (deps pipe_api.capnp)
 (action
  (run capnp compile -o %{bin:capnpc-ocaml} %{deps})))