(executable
 (name lenscap)
 (modules lenscap)
 (public_name lenscap)
 (package eon)
 (libraries dns_server_eio server_args dns_log dns_acme dns eio_main service capnp-rpc-lwt capnp-rpc-unix logs.fmt))

(executable
 (name lenscapc)
 (modules lenscapc)
 (public_name lenscapc)
 (package eon)
 (libraries service eio_main capnp-rpc-lwt capnp-rpc-unix logs.fmt))

(library
 (name service)
 (modules service service_api)
 (package eon)
 (libraries dns_acme eio_main capnp-rpc-lwt)
 (flags
  (:standard -w -53-55)))

(rule
 (targets service_api.ml service_api.mli)
 (deps service_api.capnp)
 (action
  (run capnp compile -o %{bin:capnpc-ocaml} %{deps})))